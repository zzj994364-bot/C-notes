https://codeforces.com/contest/1691/problem/B

##  鞋子乱换
 时间限制：每个测试 1 秒
 内存限制：256 MB

------

一班学生每天穿同一双鞋感到无聊，所以他们决定互相交换鞋子。在这个问题中，一双鞋是不可分割的，视为一个整体。

班上有 $n$ 个学生，你得到一个 **非递减** 数组 $s$，其中 $s_i$ 是第 $i$ 个学生的鞋码。

鞋子乱换的规则是：

1. 没有学生拿回自己的鞋子；
2. 每个学生拿到的鞋码 ≥ 他自己的鞋码。

你需要输出一个排列 $p$ 表示鞋子乱换的方案，其中第 $i$ 个学生拿到第 $p_i$ 个学生的鞋子（要求 $p_i \neq i$）。
 如果没有合法方案，则输出 −1。

------

**排列的定义**
 排列是一个包含 $n$ 个互不相同整数 $1$ 到 $n$ 的数组，例如：

- [2, 3, 1, 5, 4] 是合法排列
- [1, 2, 2] 不合法（2 出现两次）
- [1, 3, 4] 不合法（n=3，但数组中有 4）

------

**输入**

- 第一行：一个整数 $t$（$1 \le t \le 1000$）——测试用例数
- 每个测试用例：
  - 第一行：一个整数 $n$（$1 \le n \le 10^5$）——学生数
  - 第二行：$n$ 个整数 $s_1, s_2, \dots, s_n$（$1 \le s_i \le 10^9$ 且非递减，即 $s_i \le s_{i+1}$）——学生鞋码

保证所有测试用例中 $n$ 的总和 ≤ $10^5$。

------

**输出**

- 每个测试用例输出一行：
  - 如果没有合法乱换方案，输出 −1
  - 如果存在合法方案，输出 $n$ 个整数，表示第 $i$ 个学生拿到第 $p_i$ 个学生的鞋子（任何合法方案都可以）

------

**示例**

输入：

```
2
5
1 1 1 1 1
6
3 6 8 13 15 21
```

输出：

```
5 1 2 3 4
-1
```

**说明**

1. 第一个测试用例：所有学生鞋码相同，任何满足 $p_i \neq i$ 的排列都是合法的。
2. 第二个测试用例：鞋码不同，无法满足每个学生拿到鞋码 ≥ 自己鞋码且不拿自己的鞋，因此输出 −1。











## 解题思路

**把数组按相同鞋码分组，每组内部做循环移位（block-wise rotation 即可）。**
 只要所有组的大小都 ≥ 2，就一定能解。

✔ 因为同组 size 一样，互相交换满足：

- 不会拿到自己的鞋（循环移位）
- 拿到的鞋码 = 原来的鞋码 ≥ 自己的鞋码
- 不会跨组
- 满足 permutation 规则

❌ 如果某个鞋码组大小 = 1 → 这个人无法和别人互换 → 无解 → 输出 -1

## 代码实现

用双指针实现区间分组

```cpp
#include <iostream>
#include <vector>
using namespace std;

int main () {
    int t;
    cin >> t;
    while (t--) {
        int n;
        cin >> n;
        vector<int> a(n);
        for (int i = 0; i < n; i++) cin >> a[i];

        vector<int> ans(n);

        bool ok = true;
        int l = 0;
        while (l < n) {
            int r = l + 1;
            while (r < n && a[l] == a[r]) r++;
            //形成一个左闭右开[)的相同元素区间

            if (r - l == 1) {
                ok = false;
                break;
            }
            //如果只有一个元素不符合题意，不ok

            //对区间[l, r)进行循环右移
            // 例：l l+1 l+2 ... r-1 → l+1 l+2 ... r-1 l
            for (int k = l; k < r - 1; k++) {
                ans[k] = k + 2;
            }
            ans[r - 1] = l + 1;

            l = r;
       }
        if (!ok) {
            cout << -1 << '\n';
        } else {
            for (auto x : ans) {
                cout << x << ' ';
            }
            cout << '\n';
        }
    }

    return 0;
}
```

