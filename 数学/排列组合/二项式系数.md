## Binomial Coefficient

### 1. 定义与符号

二项式系数是组合数学中的一个基本概念，它表示从 $n$ 个不同元素中不重复、**不计顺序**地选取 $k$ 个元素的组合方式的数量。

#### 符号表示

二项式系数通常用以下符号表示，读作 "**$n$ 选 $k$**"（n choose k）：

$$\binom{n}{k} \quad \text{或} \quad C(n, k)$$

#### 公式定义 

根据组合的定义，二项式系数的计算公式为：

$$\binom{n}{k} = \frac{P(n, k)}{k!} = \frac{n!}{k!(n-k)!}$$

其中：

- $n$ 是元素的总数。
- $k$ 是要选取的元素的个数。
- $n!$ 是 $n$ 的阶乘。
- **约定：** 当 $k < 0$ 或 $k > n$ 时，$\binom{n}{k} = 0$。

------

### 2. 核心应用：二项式定理 (Binomial Theorem)

二项式系数之所以得名，是因为它们作为系数出现在**二项式定理**的展开式中。

二项式定理描述了任意一个二项式（两个项的和）的整数次幂的展开公式：

$$(x + y)^n = \sum_{k=0}^{n} \binom{n}{k} x^{n-k} y^k$$

####  举例

展开 $(x + y)^3$:



$$(x + y)^3 = \binom{3}{0} x^3 y^0 + \binom{3}{1} x^2 y^1 + \binom{3}{2} x^1 y^2 + \binom{3}{3} x^0 y^3$$



计算系数：

- $\binom{3}{0} = 1$

- $\binom{3}{1} = \frac{3!}{1!2!} = 3$

- $\binom{3}{2} = \frac{3!}{2!1!} = 3$

- $\binom{3}{3} = 1$

  

  $$\implies (x + y)^3 = 1x^3 + 3x^2y + 3xy^2 + 1y^3$$

------

### 3. 主要性质

二项式系数具有许多有趣的性质，常用于组合恒等式的证明：

#### 3.1. 对称性 (Symmetry)

从 $n$ 个元素中选 $k$ 个，等价于选出 $n-k$ 个不选的元素。



$$\binom{n}{k} = \binom{n}{n-k}$$

#### 3.2. 递推关系 (Pascal's Identity)

也称为帕斯卡恒等式。这是构造帕斯卡三角形（Pascal's Triangle）的基础。



$$\binom{n}{k} = \binom{n-1}{k-1} + \binom{n-1}{k}$$

- **组合解释：** 从 $n$ 个元素中选 $k$ 个，可以分为两类：
  1. 包含第 $n$ 个元素：剩下从 $n-1$ 个中选 $k-1$ 个（$\binom{n-1}{k-1}$）。
  2. 不包含第 $n$ 个元素：剩下从 $n-1$ 个中选 $k$ 个（$\binom{n-1}{k}$）。

#### 3.3. 恒等式 (Summation Identity)

将 $(x+y)^n$ 中的 $x$ 和 $y$ 都设为 $1$，根据二项式定理可得：



$$\sum_{k=0}^{n} \binom{n}{k} = \binom{n}{0} + \binom{n}{1} + \dots + \binom{n}{n} = 2^n$$

- **组合解释：** 从 $n$ 个元素中选取任意数量（从 $0$ 个到 $n$ 个），其总数等于 $n$ 个元素的子集总数，即 $2^n$。

------

### 4. 高效计算方法

在实际编程中，根据 $n$ 和 $k$ 的大小，有不同的计算方法：

| **场景**                 | **n 和 k 的范围**                      | **最佳方法**             | **复杂度**                           |
| ------------------------ | -------------------------------------- | ------------------------ | ------------------------------------ |
| **小 $n, k$**            | $n$ 较小（如 $n \le 2000$）            | **帕斯卡三角形**预处理   | $O(n^2)$ 预处理， $O(1)$ 查询        |
| **大 $n$ (模 $P$ 运算)** | $n$ 很大，需要模 $P$ 计算 ($P$ 是质数) | **阶乘预处理** + 模逆元  | $O(n + \log P)$ 预处理， $O(1)$ 查询 |
| **单次大 $n, k$**        | 只需计算一个值， $n$ 和 $k$ 较大       | **边乘边除**（避免溢出） | $O(k)$                               |

#### **模 $P$ 运算的快速计算**

当需要在模 $P$（$P$ 是质数）下计算 $\binom{n}{k}$ 时，使用**阶乘预处理**和**模逆元**是标准方法：

$$\binom{n}{k} \equiv \text{fact}[n] \cdot \text{invfact}[k] \cdot \text{invfact}[n-k] \pmod{P}$$

其中 $\text{fact}[i]$ 是 $i! \pmod{P}$，$\text{invfact}[i]$ 是 $(i!)^{-1} \pmod{P}$。